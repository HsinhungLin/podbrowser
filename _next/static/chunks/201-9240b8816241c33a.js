"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[201],{44536:function(e,t,n){n.d(t,{ZP:function(){return he}});var r=n(36864),a=n(27812),o=n(67294),l=n(40478),c=n(11163),i=n(80480),s=n(11719),u=n(79521),d=n(86010),p=n(54303),m=n(29773),f=n(35117),b=n(55517),h=n(20829),y=n(2824),v=n(23934),g=n(28585),E=n(67265),w=n(50253),x=function(e){return(0,p.createStyles)(e,["back-to-nav","input"],{avatar:{width:"64px",height:"64px",background:"transparent"},appAvatar:{textAlign:"center",padding:e.spacing(1),borderRadius:"50%",fontSize:e.typography.h5.fontSize,color:e.palette.primary.main,backgroundColor:"#F1EDFF"},avatarText:{fontFamily:e.typography.h1.fontFamily,fontSize:"1.5rem",color:e.palette.secondary.contrastText},headerLink:{display:"block",fontFamily:e.typography.body2.fontFamily,fontSize:"1rem",fontWeight:e.typography.body2.fontWeight,color:e.palette.secondary.contrastText}})},S=n(52800),k=(0,s.Z)((function(e){return(0,f.Z)(x(e))}));var Z=(0,S.Jp)(),C=(0,S.y7)();function _(e){var t=e.profileIri,n=(0,o.useState)(null),r=n[0],a=n[1],c=k(),s=(0,p.useBem)(c);if(r)return r.toString();var u=function(e){return function(){return o.createElement(E.Z,{className:e("appAvatar"),alt:"Contact avatar"},o.createElement(m.PJ,{className:e("appAvatar"),name:"project-diagram"}))}}(s);return o.createElement(l.DatasetProvider,{solidDataset:C},o.createElement(l.ThingProvider,{thing:Z,onError:a},o.createElement(w.Z,{alignItems:"center",display:"flex"},o.createElement(w.Z,null,o.createElement(E.Z,{className:c.avatar,alt:"Contact avatar"},o.createElement(l.Image,{property:S.UA,width:120,errorComponent:u}))),o.createElement(w.Z,{p:2},o.createElement("h3",{"data-testid":"app-name-title"},o.createElement(l.Text,{className:c.avatarText,property:i.ay.name}),o.createElement("a",{className:c.headerLink,href:t,rel:"noreferrer",target:"_blank"},t))))))}var T=n(76800),I=n(70422),N=n(5455),P=n(6578),A=n(21015),R=n(50029),F=n(87794),B=n.n(F),z=n(68504),U=n(14179),D=n(28e3),W=function(e){return(0,p.createStyles)(e,["back-to-nav","input"],{"revoke-button":{color:e.palette.error.main,textDecoration:"underline",background:"none",border:"none",cursor:"pointer",textAlign:"left",fontSize:"1rem"}})},L=n(46903),K=n(7513),O=n(35345),j=n(70766),J=n(35878),V=n(1124);var Y=n(55612),q=n(96361),H=n(827),G="remove-access-confirmation-dialog",M="Revoke All Access",Q=(0,s.Z)((function(e){return(0,f.Z)(W(e))}));function X(e){var t,n=e.variant,r=e.resources,a=e.onClose,c=e.accessList,i=e.setShouldUpdate,s=Q(),u=(0,p.useBem)(s),f=(0,o.useContext)(L.ZP),b=f.alertError,h=f.alertSuccess,y=(0,o.useState)(c&&(null===(t=c[0])||void 0===t?void 0:t.agent)),v=y[0],g=y[1],E=(0,l.useSession)().session,w=E.fetch,x=function(e,t){var n=(0,l.useSession)().session.fetch;return(0,O.ZP)([e,"getProfile"],(0,R.Z)(B().mark((function t(){return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return",null);case 2:if(e!==j.fL){t.next=4;break}return t.abrupt("return",{name:j.ZJ});case 4:if(e!==J.Ux){t.next=6;break}return t.abrupt("return",{name:J.wO});case 6:return t.abrupt("return",(0,V.In)(e,n));case 7:case"end":return t.stop()}}),t)}))),t)}(v),S=x.data,k=(null===S||void 0===S?void 0:S.name)||v,Z=(0,o.useContext)(K.ZP),C=Z.confirmed,_=Z.open,T=Z.setContent,I=Z.setOpen,N=Z.setTitle,A=Z.closeDialog,F=Z.setConfirmText,W=Z.setIsDangerousAction,X=(0,o.useState)(!1),$=X[0],ee=X[1],te=(0,P.Z)(E.info.webId),ne=te&&(0,H.mx)(te),re=1===r.length?(0,D.Yj)(r[0]):"anything in your Pod.",ae=function(e){var t=e.resources,n=e.policiesContainer,r=e.accessList,a=e.agentWebId,o=e.setShouldUpdate,l=e.alertError,c=e.alertSuccess,i=e.onClose,s=e.fetch;return function(){if(t){var e=(null===r||void 0===r?void 0:r.map((function(e){var t=e.allow;return{read:!!t.includes("http://www.w3.org/ns/solid/acp#Read"),write:!!t.includes("http://www.w3.org/ns/solid/acp#Write"),append:!!t.includes("http://www.w3.org/ns/solid/acp#Append"),control:!!t.includes("http://www.w3.org/ns/solid/acp#Control")}}))).map((function(e){return(0,U.yz)(e,"name")}));t.map(function(){var t=(0,R.Z)(B().mark((function t(r){var u,d;return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,z.yJ)(r,{fetch:s});case 2:return u=t.sent,t.next=5,(0,q.Rx)(u,n,s);case 5:d=t.sent,e.map(function(){var e=(0,R.Z)(B().mark((function e(t){return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.removeAgentFromPolicy(a,t);case 3:o(!0),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),(0,Y.ky)(e.t0,404)||l(e.t0.toString());case 9:return e.prev=9,c("".concat(a,"'s access succesfully revoked")),i(),e.finish(9);case 13:case"end":return e.stop()}}),e,null,[[0,6,9,13]])})));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}}({resources:r,policiesContainer:ne,accessList:c,agentWebId:v,setShouldUpdate:i,alertError:b,alertSuccess:h,onClose:a,fetch:w});(0,o.useEffect)((function(){var e;c&&c.length&&g(null===(e=c[0])||void 0===e?void 0:e.agent)}),[c]);var oe=function(){ee(!0),I(G),W(!0),N(1===r.length?"Revoke access to ".concat(re,"?"):"Revoke access from ".concat(k,"?")),F(1===r.length?"Revoke Access":M),T("".concat(k," will not be able to access ").concat(re))};return(0,o.useEffect)((function(){$&&null===C&&_===G||($&&C&&_===G&&ae(),null!==C&&(A(),ee(!1)))}),[$,C,A,_,ae]),"in-menu"===n?o.createElement(m.zx,{type:"button",variant:n,className:(0,d.Z)(u("revoke-button")),"data-testid":"access-details-remove-button",onClick:oe},"Revoke access"):o.createElement("button",{type:"button",className:u("revoke-button"),"data-testid":"revoke-access-button",onClick:oe},r.length>1?M:"Remove Access to ".concat(re,"?"))}X.defaultProps={accessList:[],variant:null,setShouldUpdate:function(){}};var $=n(62822),ee=n(50998),te=n(46869),ne=n(95757);var re=n(15259),ae=n(70936),oe=n(58112),le=n(82708),ce=function(e){return e?(0,a.Z)(new Set((0,a.Z)(e.map((function(e){return e.allow.map((function(e){return e}))}))).reduce((function(e,t){return[].concat((0,a.Z)(e),(0,a.Z)(t))}),[]))):null},ie=(0,s.Z)((function(e){return(0,f.Z)(function(e){return{"access-details--wrapper":{padding:"1.5rem",display:"flex",flexDirection:"column"},"access-details--title":{"& h2":{padding:"0 0 0 2rem",margin:0,fontFamily:e.typography.h2.fontFamily,position:"relative","& > *":{position:"absolute",left:0,top:"0.3rem"}}},"access-details--resource-info":{flexGrow:1,"& > *":{paddingLeft:"2rem"},"& p":{fontSize:"0.8125rem",margin:0,wordWrap:"break-word"}},"access-details--icon":{fontSize:"1.5rem",display:"flex",alignItems:"center",background:"linear-gradient(to right, #0D6796, #33B2D3)","-webkit-background-clip":"text",color:"transparent",marginRight:"1rem"},"access-details--section":{minWidth:"100%"},"access-details--section-header":{fontFamily:e.typography.h3.fontFamily},"access-details--section-icon":{color:"#4CAF50",fontSize:"1rem",alignItems:"flex-start"},listItemIcon:{minWidth:"fit-content",paddingRight:"0.5rem",display:"flex",alignSelf:"flex-start",paddingTop:"0.2rem"},listItemTitleText:{fontFamily:e.typography.body.fontFamily,fontSize:e.typography.body1.fontSize},listItemSecondaryText:{fontFamily:e.typography.body.fontFamily,fontSize:"0.8125rem"},"access-details--separator":{backgroundColor:e.palette.grey.A100,border:"none",height:"1px"},listItemText:{marginTop:0},"access-details--remove-access-button":{border:"none",background:"transparent",color:e.palette.error.main,textDecoration:"underline",fontSize:"1rem",cursor:"pointer",textAlign:"left",justifySelf:"flex-end"}}}(e))}));function se(e){var t,n=e.open,r=e.onClose,a=e.accessList,l=e.resourceIri,c=e.podRoot,i=e.setShouldUpdate,s=ie(),u=(0,p.useBem)(s),d=(0,le.Z)(l,{revalidateOnFocus:!1,shouldRetryOnError:!1}).data,f=(0,oe.Z)(d),b=f.data,h=f.error,y=l&&(0,D.Yj)(l),v=l&&(null===(t=(0,ae.Uw)(l))||void 0===t?void 0:t.replace(c,"")),g=ce(a),E=null===g||void 0===g?void 0:g.map((function(e){return{read:!!e.includes("Read"),write:!!e.includes("Write"),append:!!e.includes("Append"),control:!!e.includes("Control")}})),w=null===E||void 0===E?void 0:E.map((function(e){return(0,U.nY)(e)})),x=["View","Edit","Add","Share","View Sharing"],S=null===w||void 0===w?void 0:w.sort((function(e,t){return x.indexOf(e.name)-x.indexOf(t.name)}));return o.createElement(m.dy,{anchor:"top",open:n,close:r},!b&&!h&&o.createElement(A.Z,null),b&&o.createElement("div",{className:u("access-details","wrapper")},o.createElement("span",{className:u("access-details","title")},o.createElement("span",{className:u("access-details","resource-info")},o.createElement("p",null,decodeURIComponent(v)),o.createElement("h2",null," ",o.createElement(m.PJ,{name:l&&(0,re.sr)(l)?"folder":"file",className:u("access-details","icon")}),y))),o.createElement("section",{className:u("access-details","section")},o.createElement("h3",{className:u("access-details","section-header")},"Access"),o.createElement("hr",{className:u("access-details","separator")}),o.createElement($.Z,null,null===S||void 0===S?void 0:S.map((function(e){var t=e.name,n=e.icon,r=e.description;return o.createElement(ee.Z,{key:t},o.createElement(te.Z,{classes:{root:s.listItemIcon}},o.createElement(m.PJ,{name:n,className:u("access-details","section-icon")})),o.createElement(ne.Z,{classes:{root:s.listItemText,primary:s.listItemTitleText,secondary:s.listItemSecondaryText},key:t,primary:t,secondary:r}))})))),o.createElement(X,{variant:"drawer",resources:[l],onClose:r,accessList:a,setShouldUpdate:i})))}se.defaultProps={accessList:[],resourceIri:null,podRoot:null,setShouldUpdate:function(){}};var ue=n(47687),de=n(4730),pe=["children","value","panelName"];function me(e){var t=e.children,n=e.value,a=e.panelName,l=(0,de.Z)(e,pe);return o.createElement("div",(0,r.Z)({role:"tabpanel",hidden:n!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},l),n===a&&o.createElement(w.Z,{p:1,mt:3},t))}me.defaultProps={children:null};var fe=function(e){return(0,p.createStyles)(e,["back-to-nav","input"],{avatar:{width:"64px",height:"64px"},avatarText:{fontFamily:e.typography.h1.fontFamily,fontSize:"1.5rem",color:e.palette.secondary.contrastText},headerLink:{display:"block",fontFamily:e.typography.body2.fontFamily,fontSize:"1rem",fontWeight:e.typography.body2.fontWeight,color:e.palette.secondary.contrastText},container:{width:"100%",maxWidth:e.breakpoints.width("md"),paddingTop:e.spacing(1),margin:"0 auto"},"access-details--icon":{fontSize:"1.5rem",display:"flex",alignItems:"center",background:"linear-gradient(to right, #0D6796, #33B2D3)","-webkit-background-clip":"text",color:"transparent"},table__container:{border:"solid 1px",borderColor:e.palette.grey[200],borderCollapse:"collapse",boxShadow:"0 4px 12px 1px rgba(208,208,208,0.22)",borderRadius:8,paddingBottom:"0.5em",marginBottom:"1.5rem"},table:{borderCollapse:"collapse",borderRadius:8},table__header:{borderBottom:"1px solid",borderBottomColor:e.palette.grey[200]},"table__head-cell":{padding:"1em"},"table__body-row":{borderBottom:"0 !important",borderTop:"1px solid",borderTopColor:e.palette.grey[200],"&:hover":{cursor:"pointer",background:e.palette.grey[50]},"&:last-child":{borderBottom:0}},"table__body-row--active":{border:"2px solid ".concat("#3D85AB"," !important"),backgroundColor:"#E6EFF4"},"table__body-cell":{width:"2em"},"table__body-cell--interactive":{width:"auto",maxWidth:"650px",cursor:"pointer",textDecoration:"underline",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",direction:"rtl",textAlign:"left"},"revoke-button__container":{paddingBottom:"2rem"}})},be=(0,s.Z)((function(e){return(0,f.Z)(fe(e))}));function he(e){var t=e.type;(0,v.KW)();var n=(0,c.useRouter)(),s=decodeURIComponent(n.query.webId),f=m.iA.useTableClass("table","inherits");(0,v.KW)();var E=(0,l.useSession)(),w=E.session,x=E.fetch,S=(0,P.Z)(w.info.webId),k=(0,o.useState)([]),Z=k[0],C=k[1],R=(0,o.useState)([]),F=R[0],B=R[1],z=(0,o.useState)(null),W=z[0],L=z[1],K=(0,o.useState)(null),O=K[0],j=K[1],J=(0,o.useState)(null),V=J[0],Y=J[1],q=(0,o.useState)(!1),H=q[0],G=q[1],M=(0,o.useState)("Permissions"),Q=M[0],$=M[1],ee=o.createElement(m.iL,{href:"/privacy"},"privacy"),te=be(),ne=(0,p.useBem)(te),oe=[{label:"Permissions",testid:"permissions-tab",value:"Permissions"},{label:"Profile",testid:"profile-tab",value:"Profile"}],le='\n  {\n    pod(iri: "'.concat(S,'" ) {\n        accessByAgent(agent: "').concat(s,'" ) {\n        agent\n        allow\n        resource\n        }\n    }\n  }\n  ');(0,o.useEffect)((function(){S&&x("https://access.pod.inrupt.com/graphql/",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({query:le})}).then((function(e){return e.json()})).catch((function(e){Y(e)})).then((function(e){var t=e.data;if(t&&t.pod){var n=t.pod.accessByAgent;B(void 0===n?{}:n);var r=(0,a.Z)(new Set(t.pod.accessByAgent.map((function(e){return e.resource}))));C(r),G(!1)}}))}),[le,S,x,w,H]),(0,o.useEffect)((function(){var e=F.filter((function(e){return e.resource===Z[W]}));j(e)}),[F,Z,W]);var ie=o.createElement(se,{accessList:O,open:null!==W,onClose:function(){return L(null)},resourceIri:Z[W],podRoot:S,agentWebId:s,setShouldUpdate:G}),de=(0,o.useMemo)((function(){return[{header:"Icon",accessor:"icon",disableSortBy:!0},{Header:"Name",accessor:"resource"},{Header:"Access"},{header:"Actions",accessor:"actions",disableSortBy:!0}]}),[]),pe=(0,o.useMemo)((function(){return Z||[]}),[Z]),fe=(0,u.useTable)({columns:de,data:pe,defaultCanSort:!0},u.useSortBy),he=fe.getTableProps,ye=fe.getTableBodyProps,ve=fe.headerGroups,ge=fe.rows,Ee=fe.prepareRow;if(V)return V.toString();if(H)return o.createElement(A.Z,null);var we=function(e){var t=e.condition,n=e.wrapper,r=e.children;return t?n(r):r};return o.createElement(we,{condition:t!==i.fK.SoftwareApplication,wrapper:function(e){return o.createElement(l.CombinedDataProvider,{datasetUrl:s,thingUrl:s},e)}},o.createElement(m.qt,{drawer:ie,open:null!==W},o.createElement("div",{className:te.container},o.createElement(m.dK,{link:ee}),t===i.fK.SoftwareApplication?o.createElement(_,{profileIri:s}):o.createElement(g.ZP,{profileIri:s}),o.createElement(N.Z,{tabs:oe,handleTabChange:function(e,t){$(t)},selectedTabValue:Q}),o.createElement(me,{value:Q,panelName:"Permissions"},o.createElement("p",null,t===i.fK.SoftwareApplication&&o.createElement("span",null,"MockApp"),t!==i.fK.SoftwareApplication&&o.createElement(l.Text,{property:i.ay.name})," ","has access to these resources"),0===Z.length&&o.createElement(A.Z,null),0!==Z.length&&o.createElement(o.Fragment,null,o.createElement("div",{className:ne("table__container")},o.createElement("table",(0,r.Z)({className:(0,d.Z)(f,ne("table"))},he()),o.createElement("thead",{className:ne("table__header")},ve.map((function(e){return o.createElement("tr",(0,r.Z)({key:e.id},e.getHeaderGroupProps()),e.headers.map((function(e){return o.createElement("td",(0,r.Z)({key:e.id,className:ne("table__head-cell")},e.getHeaderProps(e.getSortByToggleProps())),e.render("Header")," ",o.createElement(ue.Z,{sorted:e.isSorted,sortedDesc:e.isSortedDesc}))})))}))),o.createElement("tbody",ye(),ge.map((function(e,t){Ee(e);var r=e.original,a=r&&(0,D.Yj)(r),l=(0,ae.Uw)(r).replace(S,""),c="".concat(l+a.trim()),i=F.filter((function(t){return t.resource===e.original})),s=ce(i),u=null===s||void 0===s?void 0:s.map((function(e){return{read:!!e.includes("Read"),write:!!e.includes("Write"),append:!!e.includes("Append"),control:!!e.includes("Control")}})),d=null===u||void 0===u?void 0:u.map((function(e){return(0,U.nY)(e)})),p=null===d||void 0===d?void 0:d.map((function(e){return e.name}));return o.createElement("tr",{key:r,className:"".concat(W===t?ne("table__body-row","active"):ne("table__body-row"))},o.createElement("td",{className:ne("table__body-cell")},o.createElement(m.PJ,{name:r&&(0,re.sr)(r)?"folder":"file",className:ne("access-details","icon")})),o.createElement("td",{className:ne("table__body-cell","interactive"),onClick:function(){return L(t)},onKeyDown:function(){return L(t)}},decodeURIComponent(c)),o.createElement("td",null,null===p||void 0===p?void 0:p.join(", ")),o.createElement("td",{className:ne("table__body-cell")},o.createElement(m.Kk,null,o.createElement(m.zx,{variant:"in-menu",onClick:function(){return L(t)}},"Details"),o.createElement(m.zx,{onClick:(0,y.GC)(Z[t],(0,ae.Uw)(r),n),variant:"in-menu"},"View Resource"),o.createElement(b.Z,null),o.createElement(X,{variant:"in-menu",onClose:function(){return L(null)},accessList:i,resources:[Z[t]],setShouldUpdate:G}))))}))))),o.createElement("div",{className:ne("revoke-button__container")},o.createElement(X,{variant:"all-access",onClose:function(){return n.push("/privacy")},accessList:F,resources:Z})))),o.createElement(me,{value:Q,panelName:"Profile"},t===i.fK.SoftwareApplication?o.createElement(I.ZP,{profileIri:s}):o.createElement(T.ZP,{profileIri:s})),o.createElement(h.ZP,null))))}},5455:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(67294),a=n(86010),o=n(11719),l=n(35117),c=n(57821),i=n(41423),s=n(54303);function u(e){var t=e.handleTabChange,n=e.selectedTabValue,u=e.className,d=e.tabs,p=e.children,m=(0,o.Z)((function(e){return(0,l.Z)(function(e){return(0,s.createStyles)(e,["icons","table"],{tabsContainer:{display:"flex",justifyContent:"space-between",paddingLeft:e.spacing(1.2),paddingRight:e.spacing(1.2),borderBottom:"1px solid ".concat(e.palette.grey.A100)},tab:{textTransform:"none",minWidth:"max-content",fontFamily:e.typography.body1.fontFamily,fontSize:e.typography.body1.fontSize,color:e.palette.primary.text},selected:{color:e.palette.primary.main},indicator:{height:"3px",width:"100%",backgroundColor:e.palette.primary.main}})}(e))}))();return r.createElement("div",{className:(0,a.Z)(m.tabsContainer,u)},r.createElement(c.Z,{classes:{indicator:m.indicator},value:n,onChange:t,"aria-label":"Filter tabs"},d.map((function(e){return r.createElement(i.Z,{key:e.label,classes:{root:m.tab,selected:m.selected},label:e.label,"data-testid":e.testid,value:e.value})}))),p)}u.defaultProps={className:null,selectedTabValue:null,children:null}},62036:function(e,t,n){n.d(t,{BU:function(){return c},YZ:function(){return s},T3:function(){return u},_r:function(){return i}});var r=n(35863),a=n(1300),o=n(11847),l=n(89946);function c(e){if((0,o.ke)(e)){return function(e){const t=(0,l.h8)(e),n=(0,l.nl)(t,e.internal_accessTo);return m(d(n))}((0,o.Rq)(e))}if((0,o.vd)(e)){return s((0,o.OP)(e))}return null}function i(e,t,n){return(0,l.Ie)(e,n,a.tR.agent,"resource",t)}function s(e){const t=(0,l.h8)(e);return m(d((0,l.tw)(t,e.internal_accessTo)))}function u(e,t,n){return(0,l.Ie)(e,n,a.tR.agent,"default",t)}function d(e){return e.filter(p)}function p(e){return null!==(0,r.nn)(e,a.tR.agent)}function m(e){return(0,l.wr)(e,a.tR.agent)}}}]);
//# sourceMappingURL=201-9240b8816241c33a.js.map