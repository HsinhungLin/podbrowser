{"version":3,"file":"static/chunks/pages/profile-1af8d11e0b5437d6.js","mappings":"+PAsCe,SAASA,EAAQC,GAC9B,IAAQC,EAA8BD,EAA9BC,WAAYC,EAAkBF,EAAlBE,QAASC,EAASH,EAATG,KAC7B,GAA0BC,EAAAA,EAAAA,UAAS,MAA5BC,EAAP,KAAcC,EAAd,KAGA,OAAID,GACEE,EAAAA,EAAAA,IAAYF,EAAO,KAEnB,gBAAC,IAAD,CAAOG,SAAS,SAAhB,8CAC0CP,IAIvCI,EAAMI,WAGXN,IAASO,EAAAA,GAAAA,oBACJ,gBAAC,KAAD,MAIP,gBAAC,EAAAC,qBAAD,CACEC,WAAYX,EACZY,SAAUZ,EACVa,QAASR,GAET,gBAAC,KAAD,KACE,gBAAC,IAAD,CAAOS,MAAO,CAAEC,UAAW,QACzB,gBAAC,IAAD,CAAKC,EAAG,GACN,gBAAC,KAAD,CAAchB,WAAYA,IAC1B,2BACA,gBAAC,KAAD,CAAeA,WAAYA,EAAYC,QAASA,QAc5DH,EAAQmB,aAAe,CACrBhB,SAAS,EACTC,KAAM,O,2IC1DO,SAASgB,KACtBC,EAAAA,EAAAA,MACA,OACEC,EAAAA,EAAAA,YAAWC,EAAAA,gBADLC,EAAR,EAAQA,QAASC,EAAjB,EAAiBA,yBAA0BC,EAA3C,EAA2CA,QAG3C,GAAID,IAA6BC,EAC/B,OAAO,KAET,IAAcC,GAAyBC,EAAAA,EAAAA,IACrCF,EAAQG,cADFC,KAIFC,EACJJ,EAAqBK,OAASL,EAAqBM,OAC/CC,EAAiBH,EAAsB,OACzCL,QADyC,IACzCA,OADyC,EACzCA,EAASG,aADgC,OAEzCH,QAFyC,IAEzCA,OAFyC,EAEzCA,EAASS,cAAc,GACrBjC,EAAa6B,EACfP,EAAQY,KAAKC,OACbC,EAAAA,EAAAA,IAAaJ,GAEjB,OAAO,gBAAC,KAAD,CAAShC,WAAYA,EAAYC,SAAO,ICvBlC,SAASH,IACtB,OAAO,gBAAC,EAAD,Q,gKCDIuC,EACA,YADAA,EAEC,aAGP,SAAeC,EAAtB,wC,wCAAO,WACLC,EACAhB,EACAiB,EACAC,GAJK,qEAMDlB,EANC,qDAWHgB,GACAC,IAA2BH,EAZxB,gCAcGK,EAAAA,QAAAA,KAAYD,GAdf,UAkBFF,GACDC,IAA2BH,EAnBxB,gCAqBGK,EAAAA,QAAAA,KAAYD,GArBf,4C,sBAyBA,SAAStB,IAA4C,IAArBsB,EAAqB,uDAAV,SAChD,GAA8CE,EAAAA,EAAAA,cAAtCrB,EAAR,EAAQA,QAASC,EAAjB,EAAiBA,0BAEjBqB,EAAAA,EAAAA,YAAU,WACJtB,EAAQY,KAAKW,YACjBP,EACEhB,EAAQY,KAAKW,WACbtB,EACAc,EACAI,MAKC,SAASK,IAAsC,IAAhBL,EAAgB,uDAAL,IAC/C,GAA8CE,EAAAA,EAAAA,cAAtCrB,EAAR,EAAQA,QAASC,EAAjB,EAAiBA,yBACXwB,GAASC,EAAAA,EAAAA,cACfJ,EAAAA,EAAAA,YAAU,WAELtB,EAAQY,KAAKW,aAAeE,EAAOE,OAAOC,SAAS,UACpD3B,GAGFe,EACEhB,EAAQY,KAAKW,WACbtB,EACAc,EACAI,KAED,CAACnB,EAASyB,EAAQN,EAAUlB,M,uBCnF5B4B,OAAOC,SAAWD,OAAOC,UAAY,IAAIC,KAAK,CAC7C,WACA,WACE,OAAO,EAAQ,Y","sources":["webpack://_N_E/./components/profile/index.jsx","webpack://_N_E/./components/pages/profile/index.jsx","webpack://_N_E/./pages/profile.jsx","webpack://_N_E/./src/effects/auth/index.js","webpack://_N_E/?814b"],"sourcesContent":["/**\n * Copyright 2020 Inrupt Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal in\n * the Software without restriction, including without limitation the rights to use,\n * copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n * Software, and to permit persons to whom the Software is furnished to do so,\n * subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n */\n\nimport React, { useState } from \"react\";\nimport T from \"prop-types\";\nimport { Box, Paper } from \"@material-ui/core\";\nimport { Alert } from \"@material-ui/lab\";\nimport { Container } from \"@inrupt/prism-react-components\";\nimport { CombinedDataProvider } from \"@inrupt/solid-ui-react\";\nimport { schema } from \"rdf-namespaces\";\nimport { isHTTPError } from \"../../src/error\";\nimport PersonProfile from \"./personProfile\";\nimport PersonAvatar from \"./personAvatar\";\nimport AppProfile from \"./appProfile\";\n\nexport const TESTCAFE_ID_NAME_TITLE = \"profile-name-title\";\nexport const TESTCAFE_ID_NAME_FIELD = \"profile-name-field\";\nexport const TESTCAFE_ID_ROLE_FIELD = \"profile-role-field\";\nexport const TESTCAFE_ID_ORG_FIELD = \"profile-org-field\";\n\nexport default function Profile(props) {\n  const { profileIri, editing, type } = props;\n  const [error, setError] = useState(null);\n\n  // TODO replace with toast error or something?\n  if (error) {\n    if (isHTTPError(error, 404)) {\n      return (\n        <Alert severity=\"error\">\n          {`Cannot fetch avatar for this WebID: ${profileIri}`}\n        </Alert>\n      );\n    }\n    return error.toString();\n  }\n\n  if (type === schema.SoftwareApplication) {\n    return <AppProfile />;\n  }\n\n  return (\n    <CombinedDataProvider\n      datasetUrl={profileIri}\n      thingUrl={profileIri}\n      onError={setError}\n    >\n      <Container>\n        <Paper style={{ marginTop: \"1em\" }}>\n          <Box p={2}>\n            <PersonAvatar profileIri={profileIri} />\n            <hr />\n            <PersonProfile profileIri={profileIri} editing={editing} />\n          </Box>\n        </Paper>\n      </Container>\n    </CombinedDataProvider>\n  );\n}\n\nProfile.propTypes = {\n  profileIri: T.string.isRequired,\n  editing: T.bool,\n  type: T.string,\n};\n\nProfile.defaultProps = {\n  editing: false,\n  type: null,\n};\n","/**\n * Copyright 2020 Inrupt Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal in\n * the Software without restriction, including without limitation the rights to use,\n * copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n * Software, and to permit persons to whom the Software is furnished to do so,\n * subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n */\n\nimport React, { useContext } from \"react\";\nimport { SessionContext } from \"@inrupt/solid-ui-react\";\nimport { getEffectiveAccess, getSourceUrl } from \"@inrupt/solid-client\";\nimport { useRedirectIfLoggedOut } from \"../../../src/effects/auth\";\nimport Profile from \"../../profile\";\n\nexport default function ProfileShow() {\n  useRedirectIfLoggedOut();\n  const { session, sessionRequestInProgress, profile } =\n    useContext(SessionContext);\n\n  if (sessionRequestInProgress || !profile) {\n    return null;\n  }\n  const { user: profileEditingAccess } = getEffectiveAccess(\n    profile.webIdProfile\n  );\n\n  const isWebIdProfileEditable =\n    profileEditingAccess.write || profileEditingAccess.append;\n  const profileDataset = isWebIdProfileEditable\n    ? profile?.webIdProfile\n    : profile?.altProfileAll[0];\n  const profileIri = isWebIdProfileEditable\n    ? session.info.webId\n    : getSourceUrl(profileDataset);\n\n  return <Profile profileIri={profileIri} editing />;\n}\n","/**\n * Copyright 2020 Inrupt Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal in\n * the Software without restriction, including without limitation the rights to use,\n * copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n * Software, and to permit persons to whom the Software is furnished to do so,\n * subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n */\n\nimport React from \"react\";\n\nimport ProfilePage from \"../components/pages/profile\";\n\nexport default function Profile() {\n  return <ProfilePage />;\n}\n","/**\n * Copyright 2020 Inrupt Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal in\n * the Software without restriction, including without limitation the rights to use,\n * copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n * Software, and to permit persons to whom the Software is furnished to do so,\n * subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n */\n\nimport { useEffect } from \"react\";\nimport Router, { useRouter } from \"next/router\";\nimport { useSession } from \"@inrupt/solid-ui-react\";\n\nexport const SESSION_STATES = {\n  LOGGED_IN: \"LOGGED_IN\",\n  LOGGED_OUT: \"LOGGED_OUT\",\n};\n\nexport async function redirectBasedOnSessionState(\n  sessionIsLoggedIn,\n  sessionRequestInProgress,\n  redirectIfSessionState,\n  location\n) {\n  if (sessionRequestInProgress) {\n    return;\n  }\n\n  if (\n    sessionIsLoggedIn &&\n    redirectIfSessionState === SESSION_STATES.LOGGED_IN\n  ) {\n    await Router.push(location);\n  }\n\n  if (\n    !sessionIsLoggedIn &&\n    redirectIfSessionState === SESSION_STATES.LOGGED_OUT\n  ) {\n    await Router.push(location);\n  }\n}\n\nexport function useRedirectIfLoggedOut(location = \"/login\") {\n  const { session, sessionRequestInProgress } = useSession();\n\n  useEffect(() => {\n    if (session.info.isLoggedIn) return;\n    redirectBasedOnSessionState(\n      session.info.isLoggedIn,\n      sessionRequestInProgress,\n      SESSION_STATES.LOGGED_OUT,\n      location\n    );\n  });\n}\n\nexport function useRedirectIfLoggedIn(location = \"/\") {\n  const { session, sessionRequestInProgress } = useSession();\n  const router = useRouter();\n  useEffect(() => {\n    if (\n      (session.info.isLoggedIn && !router.asPath.includes(\"login\")) ||\n      sessionRequestInProgress\n    )\n      return;\n    redirectBasedOnSessionState(\n      session.info.isLoggedIn,\n      sessionRequestInProgress,\n      SESSION_STATES.LOGGED_IN,\n      location\n    );\n  }, [session, router, location, sessionRequestInProgress]);\n}\n","\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/profile\",\n      function () {\n        return require(\"private-next-pages/profile.jsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/profile\"])\n      });\n    }\n  "],"names":["Profile","props","profileIri","editing","type","useState","error","setError","isHTTPError","severity","toString","schema","CombinedDataProvider","datasetUrl","thingUrl","onError","style","marginTop","p","defaultProps","ProfileShow","useRedirectIfLoggedOut","useContext","SessionContext","session","sessionRequestInProgress","profile","profileEditingAccess","getEffectiveAccess","webIdProfile","user","isWebIdProfileEditable","write","append","profileDataset","altProfileAll","info","webId","getSourceUrl","SESSION_STATES","redirectBasedOnSessionState","sessionIsLoggedIn","redirectIfSessionState","location","Router","useSession","useEffect","isLoggedIn","useRedirectIfLoggedIn","router","useRouter","asPath","includes","window","__NEXT_P","push"],"sourceRoot":""}